# Redis Sentinel Configuration
# High availability monitoring and failover for Redis cluster

# Basic sentinel configuration
port 26379
bind 0.0.0.0
dir /tmp

# Sentinel authentication
# requirepass your-sentinel-password
# sentinel auth-pass mymaster your-redis-password

# Monitor Redis masters
# Monitor primary Redis instances in the cluster
sentinel monitor redis-master-1 127.0.0.1 7000 2
sentinel monitor redis-master-2 127.0.0.1 7001 2
sentinel monitor redis-master-3 127.0.0.1 7002 2

# Failover configuration
sentinel down-after-milliseconds redis-master-1 30000
sentinel down-after-milliseconds redis-master-2 30000
sentinel down-after-milliseconds redis-master-3 30000

sentinel parallel-syncs redis-master-1 1
sentinel parallel-syncs redis-master-2 1
sentinel parallel-syncs redis-master-3 1

sentinel failover-timeout redis-master-1 180000
sentinel failover-timeout redis-master-2 180000
sentinel failover-timeout redis-master-3 180000

# Sentinel scripts for notifications
# sentinel notification-script redis-master-1 /var/redis/notify.sh
# sentinel client-reconfig-script redis-master-1 /var/redis/reconfig.sh

# Logging
logfile /var/log/redis/sentinel.log
loglevel notice
syslog-enabled yes
syslog-ident sentinel

# Announce configuration for Docker/Kubernetes
# sentinel announce-ip 10.0.0.100
# sentinel announce-port 26379

# Configuration for master selection
sentinel deny-scripts-reconfig yes

# Client connection limits
sentinel tcp-keepalive 60

# Configuration persistence
sentinel config-epoch redis-master-1 0
sentinel config-epoch redis-master-2 0
sentinel config-epoch redis-master-3 0

# Leader election and quorum
sentinel leader-epoch redis-master-1 0
sentinel leader-epoch redis-master-2 0
sentinel leader-epoch redis-master-3 0

# Network configuration
protected-mode no
tcp-backlog 511

# Memory and performance
# sentinel simulate-failure-flags +crash-after-election +crash-after-promotion

# Custom scripts for advanced failover scenarios
# sentinel notification-script redis-master-1 /usr/local/bin/redis-notify.py
# sentinel client-reconfig-script redis-master-1 /usr/local/bin/redis-reconfig.py

# Resolve hostnames
sentinel resolve-hostnames yes
sentinel announce-hostnames yes